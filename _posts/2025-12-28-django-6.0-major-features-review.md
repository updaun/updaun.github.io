---
layout: post
title: "Django 6.0 ì£¼ìš” ê¸°ëŠ¥ ë¦¬ë·°: django-ninja ê°œë°œìê°€ ì•Œì•„ì•¼ í•  ê²ƒë“¤"
date: 2025-12-28 10:00:00 +0900
categories: [Django, Python, Web Development]
tags: [Django, Python, Web Framework, Backend, django-ninja, API, Background Tasks, CSP, Security]
---

Django 6.0ì´ 2025ë…„ 12ì›” 3ì¼ì— ê³µì‹ ë¦´ë¦¬ìŠ¤ë˜ì—ˆìŠµë‹ˆë‹¤. ì´ë²ˆ ë²„ì „ì€ Content Security Policy ì§€ì›, Template Partials, Background Tasks í”„ë ˆì„ì›Œí¬ ë“± ë§ì€ ìƒˆë¡œìš´ ê¸°ëŠ¥ì„ í¬í•¨í•˜ê³  ìˆìŠµë‹ˆë‹¤. íŠ¹íˆ django-ninjaë¥¼ ì£¼ë¡œ ì‚¬ìš©í•˜ëŠ” API ê°œë°œì ê´€ì ì—ì„œ ì–´ë–¤ ë³€í™”ê°€ ìˆëŠ”ì§€, ì–´ë–¤ ë¶€ë¶„ì„ ì£¼ì˜í•´ì•¼ í•˜ëŠ”ì§€ ìƒì„¸íˆ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.

## ğŸ“‹ Python í˜¸í™˜ì„± ë° ì—…ê·¸ë ˆì´ë“œ í•„ìˆ˜ ì‚¬í•­

### Python ë²„ì „ ìš”êµ¬ì‚¬í•­

Django 6.0ì€ **Python 3.12 ì´ìƒ**ì„ ìš”êµ¬í•©ë‹ˆë‹¤. Python 3.10ê³¼ 3.11 ì§€ì›ì´ ì™„ì „íˆ ì¤‘ë‹¨ë˜ì—ˆìŠµë‹ˆë‹¤.

**ì§€ì› ë²„ì „:**
- Python 3.12 âœ…
- Python 3.13 âœ…
- Python 3.14 âœ…

**django-ninja ê°œë°œì ì£¼ì˜ì‚¬í•­:**
Django-ninjaëŠ” Python 3.7+ë¥¼ ì§€ì›í•˜ì§€ë§Œ, Django 6.0ì„ ì‚¬ìš©í•˜ë ¤ë©´ Python 3.12 ì´ìƒìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œí•´ì•¼ í•©ë‹ˆë‹¤. ëŒ€ë¶€ë¶„ì˜ django-ninja í”„ë¡œì íŠ¸ëŠ” í˜¸í™˜ì„± ë¬¸ì œ ì—†ì´ Python 3.12ë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
# ì—…ê·¸ë ˆì´ë“œ ì „ í™•ì¸ ì‚¬í•­
# pyproject.toml or requirements.txt
Django>=6.0
django-ninja>=1.3.0  # Python 3.12 í˜¸í™˜ ë²„ì „
```

### ì£¼ìš” ì˜ì¡´ì„± ë²„ì „ ìš”êµ¬ì‚¬í•­

Python 3.12 í˜¸í™˜ì„ ìœ„í•´ ë‹¤ìŒ ë¼ì´ë¸ŒëŸ¬ë¦¬ë“¤ë„ ìµœì‹  ë²„ì „ìœ¼ë¡œ ì—…ë°ì´íŠ¸í•´ì•¼ í•©ë‹ˆë‹¤:

```python
# requirements.txt
Django>=6.0
django-ninja>=1.3.0
psycopg>=3.1.12  # PostgreSQL ì‚¬ìš© ì‹œ
psycopg2>=2.9.9  # ë˜ëŠ” psycopg2 ì‚¬ìš© ì‹œ
redis-py>=5.1.0  # Redis ì‚¬ìš© ì‹œ
Pillow>=10.1.0  # ì´ë¯¸ì§€ ì²˜ë¦¬ ì‹œ
```

**ì—…ê·¸ë ˆì´ë“œ ì²´í¬ë¦¬ìŠ¤íŠ¸:**
1. Python 3.12+ ì„¤ì¹˜ ë° ê°€ìƒí™˜ê²½ ì¬ìƒì„±
2. ëª¨ë“  ì˜ì¡´ì„± ë¼ì´ë¸ŒëŸ¬ë¦¬ ë²„ì „ í™•ì¸ ë° ì—…ë°ì´íŠ¸
3. í…ŒìŠ¤íŠ¸ ì‹¤í–‰ìœ¼ë¡œ í˜¸í™˜ì„± ê²€ì¦
4. CI/CD íŒŒì´í”„ë¼ì¸ì˜ Python ë²„ì „ ì—…ë°ì´íŠ¸

## ğŸš€ Django 6.0ì˜ ê°€ì¥ ì¤‘ìš”í•œ ê¸°ëŠ¥: Background Tasks

### Background Tasks í”„ë ˆì„ì›Œí¬ ë„ì…

Django 6.0ì—ì„œ ê°€ì¥ ì£¼ëª©í•  ë§Œí•œ ê¸°ëŠ¥ì€ **ë‚´ì¥ Background Tasks í”„ë ˆì„ì›Œí¬**ì…ë‹ˆë‹¤. ì´ì œ Celeryë‚˜ Django-RQ ê°™ì€ ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì—†ì´ë„ ë°±ê·¸ë¼ìš´ë“œ ì‘ì—…ì„ ì²˜ë¦¬í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**django-ninja ê°œë°œìì—ê²Œ ì¤‘ìš”í•œ ì´ìœ :**
- API ì‘ë‹µ ì‹œê°„ì„ ê°œì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
- ì´ë©”ì¼ ë°œì†¡, ì´ë¯¸ì§€ ì²˜ë¦¬ ë“± ì‹œê°„ì´ ê±¸ë¦¬ëŠ” ì‘ì—…ì„ ë¹„ë™ê¸°ë¡œ ì²˜ë¦¬
- ë” ë‚˜ì€ ì‚¬ìš©ì ê²½í—˜ ì œê³µ

### ê¸°ë³¸ ì‚¬ìš©ë²•

**1. Task ì •ì˜í•˜ê¸°**

```python
# tasks.py
from django.core.mail import send_mail
from django.tasks import task


@task
def send_welcome_email(user_email: str, username: str):
    """í™˜ì˜ ì´ë©”ì¼ì„ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ë°œì†¡"""
    subject = f"{username}ë‹˜, í™˜ì˜í•©ë‹ˆë‹¤!"
    message = f"íšŒì›ê°€ì…ì„ ì¶•í•˜ë“œë¦½ë‹ˆë‹¤, {username}ë‹˜!"
    
    return send_mail(
        subject=subject,
        message=message,
        from_email=None,
        recipient_list=[user_email],
    )


@task
def process_image(image_path: str, user_id: int):
    """ì´ë¯¸ì§€ë¥¼ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì²˜ë¦¬"""
    from PIL import Image
    
    # ì´ë¯¸ì§€ ë¦¬ì‚¬ì´ì§•, ì¸ë„¤ì¼ ìƒì„± ë“±
    image = Image.open(image_path)
    image.thumbnail((800, 800))
    image.save(image_path)
    
    return {"status": "success", "user_id": user_id}
```

**2. django-ninja APIì—ì„œ Task ì‹¤í–‰í•˜ê¸°**

```python
# api.py
from ninja import NinjaAPI, Schema
from .tasks import send_welcome_email, process_image

api = NinjaAPI()


class UserCreateSchema(Schema):
    username: str
    email: str
    password: str


@api.post("/users")
def create_user(request, data: UserCreateSchema):
    # ì‚¬ìš©ì ìƒì„± (ë¹ ë¥¸ ë™ê¸° ì²˜ë¦¬)
    user = User.objects.create_user(
        username=data.username,
        email=data.email,
        password=data.password
    )
    
    # í™˜ì˜ ì´ë©”ì¼ì€ ë°±ê·¸ë¼ìš´ë“œì—ì„œ ë°œì†¡ (ë¹„ë™ê¸°)
    send_welcome_email.enqueue(
        user_email=user.email,
        username=user.username
    )
    
    # APIëŠ” ì¦‰ì‹œ ì‘ë‹µ ë°˜í™˜
    return {
        "id": user.id,
        "username": user.username,
        "email": user.email,
        "message": "ì‚¬ìš©ìê°€ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤. í™˜ì˜ ì´ë©”ì¼ì„ ë°œì†¡ ì¤‘ì…ë‹ˆë‹¤."
    }


@api.post("/images/upload")
def upload_image(request, file: UploadedFile):
    # íŒŒì¼ ì €ì¥ (ë¹ ë¥¸ ë™ê¸° ì²˜ë¦¬)
    file_path = save_uploaded_file(file)
    
    # ì´ë¯¸ì§€ ì²˜ë¦¬ëŠ” ë°±ê·¸ë¼ìš´ë“œì—ì„œ ì‹¤í–‰
    process_image.enqueue(
        image_path=file_path,
        user_id=request.user.id
    )
    
    return {
        "status": "uploaded",
        "message": "ì´ë¯¸ì§€ê°€ ì—…ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤. ì²˜ë¦¬ ì¤‘ì…ë‹ˆë‹¤."
    }
```

### Settings ì„¤ì •

```python
# settings.py
TASKS = {
    "default": {
        "BACKEND": "django.core.tasks.backends.database.DatabaseBackend",
    },
    # ë˜ëŠ” Redisë¥¼ ë°±ì—”ë“œë¡œ ì‚¬ìš©
    "redis": {
        "BACKEND": "django.core.tasks.backends.redis.RedisBackend",
        "LOCATION": "redis://localhost:6379/0",
    }
}
```

**ì¤‘ìš”: Worker í”„ë¡œì„¸ìŠ¤ í•„ìš”**

DjangoëŠ” taskë¥¼ íì— ë„£ëŠ” ê²ƒë§Œ ë‹´ë‹¹í•˜ê³ , **ì‹¤ì œ ì‹¤í–‰ì€ ë³„ë„ì˜ worker í”„ë¡œì„¸ìŠ¤ê°€ í•„ìš”**í•©ë‹ˆë‹¤. ì´ëŠ” Celeryì™€ ìœ ì‚¬í•œ ì•„í‚¤í…ì²˜ì…ë‹ˆë‹¤.

```bash
# Worker ì‹¤í–‰ (í–¥í›„ Django ëª…ë ¹ì–´ë¡œ ì œê³µë  ì˜ˆì •)
# í˜„ì¬ëŠ” ì„œë“œíŒŒí‹° íŒ¨í‚¤ì§€ê°€ í•„ìš”í•  ìˆ˜ ìˆìŒ
python manage.py run_tasks_worker
```

### django-ninja + Background Tasks ì‹¤ì „ ì˜ˆì œ

**ì‹¤ì‹œê°„ ì•Œë¦¼ì´ í•„ìš”í•œ API**

```python
from ninja import NinjaAPI, Schema
from django.tasks import task
from typing import List

api = NinjaAPI()


@task
def send_notification_to_users(user_ids: List[int], message: str):
    """ì—¬ëŸ¬ ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼ ë°œì†¡"""
    from .models import Notification
    
    notifications = [
        Notification(user_id=uid, message=message)
        for uid in user_ids
    ]
    Notification.objects.bulk_create(notifications)
    
    # ì‹¤ì œ í‘¸ì‹œ ì•Œë¦¼ë„ ë°œì†¡
    for user_id in user_ids:
        send_push_notification(user_id, message)


@api.post("/announcements")
def create_announcement(request, message: str):
    """ê³µì§€ì‚¬í•­ ìƒì„± ë° ì „ì²´ ì‚¬ìš©ìì—ê²Œ ì•Œë¦¼"""
    
    # ê³µì§€ì‚¬í•­ ìƒì„± (ë¹ ë¦„)
    announcement = Announcement.objects.create(
        message=message,
        created_by=request.user
    )
    
    # ëª¨ë“  ì‚¬ìš©ì ID ì¡°íšŒ (ë¹ ë¦„)
    user_ids = list(User.objects.values_list('id', flat=True))
    
    # ì•Œë¦¼ ë°œì†¡ì€ ë°±ê·¸ë¼ìš´ë“œì—ì„œ (ëŠë¦¼, ë¹„ë™ê¸° ì²˜ë¦¬)
    send_notification_to_users.enqueue(
        user_ids=user_ids,
        message=message
    )
    
    return {
        "id": announcement.id,
        "message": "ê³µì§€ì‚¬í•­ì´ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤.",
        "notifying_users": len(user_ids)
    }
```

### Background Tasks vs Celery

**ì¥ì :**
- ì¶”ê°€ ì˜ì¡´ì„± ì—†ìŒ (Django ë‚´ì¥)
- ì„¤ì •ì´ ê°„ë‹¨í•¨
- Django ORMê³¼ ì™„ë²½í•œ í†µí•©

**ë‹¨ì :**
- ê¸°ëŠ¥ì´ ì œí•œì  (Celeryì— ë¹„í•´)
- Worker ê´€ë¦¬ ë„êµ¬ê°€ ì•„ì§ ì„±ìˆ™í•˜ì§€ ì•ŠìŒ
- í”„ë¡œë•ì…˜ ì‚¬ìš©ì—ëŠ” ì‹ ì¤‘í•œ ì ‘ê·¼ í•„ìš”

**django-ninja ê°œë°œìë¥¼ ìœ„í•œ ì¶”ì²œ:**
- **ì†Œê·œëª¨ í”„ë¡œì íŠ¸**: Background Tasks ì‚¬ìš©
- **ëŒ€ê·œëª¨ í”„ë¡œì íŠ¸**: ì—¬ì „íˆ Celery ì‚¬ìš© ê¶Œì¥
- **ë§ˆì´ê·¸ë ˆì´ì…˜ ê³„íš**: ì²œì²œíˆ Background Tasksë¡œ ì „í™˜ ê³ ë ¤

## ğŸ”’ Content Security Policy (CSP) ë‚´ì¥ ì§€ì›

### CSPë€ ë¬´ì—‡ì¸ê°€?

Content Security PolicyëŠ” **XSS(Cross-Site Scripting) ê³µê²©ì„ ë°©ì–´**í•˜ëŠ” ë³´ì•ˆ í—¤ë”ì…ë‹ˆë‹¤. ë¸Œë¼ìš°ì €ì—ê²Œ ì–´ë–¤ ì†ŒìŠ¤ì˜ ì½˜í…ì¸ (ìŠ¤í¬ë¦½íŠ¸, ìŠ¤íƒ€ì¼, ì´ë¯¸ì§€ ë“±)ë¥¼ ë¡œë“œí•  ìˆ˜ ìˆëŠ”ì§€ ëª…ì‹œì ìœ¼ë¡œ ì§€ì‹œí•©ë‹ˆë‹¤.

Django 6.0 ì´ì „ì—ëŠ” `django-csp` ê°™ì€ ì„œë“œíŒŒí‹° íŒ¨í‚¤ì§€ê°€ í•„ìš”í–ˆì§€ë§Œ, ì´ì œëŠ” Djangoì— ë‚´ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.

### django-ninja APIì—ì„œ CSPê°€ ì¤‘ìš”í•œ ì´ìœ 

**API ì‘ë‹µì— HTMLì„ í¬í•¨í•˜ëŠ” ê²½ìš°:**
- Admin ì¸í„°í˜ì´ìŠ¤ë¥¼ í•¨ê»˜ ì œê³µí•˜ëŠ” ê²½ìš°
- API ë¬¸ì„œ í˜ì´ì§€ (Swagger UI)
- ì´ë©”ì¼ í…œí”Œë¦¿ ë¯¸ë¦¬ë³´ê¸° API
- íŒŒì¼ ì—…ë¡œë“œ í›„ ë¯¸ë¦¬ë³´ê¸° ê¸°ëŠ¥

**django-ninjaì˜ ìë™ ë¬¸ì„œí™” ê¸°ëŠ¥:**
django-ninjaëŠ” ìë™ìœ¼ë¡œ Swagger UIë¥¼ ì œê³µí•˜ëŠ”ë°, ì´ í˜ì´ì§€ì—ë„ CSPë¥¼ ì ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

### ê¸°ë³¸ ì„¤ì •

```python
# settings.py
from django.utils.csp import CSP

MIDDLEWARE = [
    # ... ë‹¤ë¥¸ ë¯¸ë“¤ì›¨ì–´
    "django.middleware.csp.ContentSecurityPolicyMiddleware",
]

# CSP ì •ì±… ì„¤ì •
SECURE_CSP = {
    "default-src": [CSP.SELF],  # ê¸°ë³¸ì ìœ¼ë¡œ ìì‹ ì˜ ë„ë©”ì¸ë§Œ í—ˆìš©
    "script-src": [
        CSP.SELF,
        CSP.NONCE,  # ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ì— nonce ì‚¬ìš©
    ],
    "style-src": [
        CSP.SELF,
        CSP.NONCE,
    ],
    "img-src": [
        CSP.SELF,
        "https:",  # ëª¨ë“  HTTPS ì´ë¯¸ì§€ í—ˆìš©
    ],
    "connect-src": [
        CSP.SELF,
        "https://api.example.com",  # API ë„ë©”ì¸ í—ˆìš©
    ],
}
```

### django-ninja APIì—ì„œ CSP ì ìš©í•˜ê¸°

**Viewë³„ë¡œ CSP ì •ì±… ì»¤ìŠ¤í„°ë§ˆì´ì§•:**

```python
# api.py
from ninja import NinjaAPI
from django.views.decorators.csp import csp_update, csp_replace

api = NinjaAPI()


# ê¸°ë³¸ CSP ì •ì±… ì‚¬ìš©
@api.get("/users")
def list_users(request):
    users = User.objects.all()
    return [{"id": u.id, "name": u.username} for u in users]


# íŠ¹ì • APIì—ì„œ CSP ì •ì±… ë³€ê²½
@api.get("/dashboard")
@csp_update(script_src=["https://cdn.example.com"])
def dashboard(request):
    """ì™¸ë¶€ CDNì˜ ìŠ¤í¬ë¦½íŠ¸ê°€ í•„ìš”í•œ ê²½ìš°"""
    return {"message": "Dashboard with external scripts"}


# CSP ì™„ì „íˆ êµì²´
@api.get("/widget")
@csp_replace(default_src=["*"])
def widget_endpoint(request):
    """íŠ¹ìˆ˜í•œ ê²½ìš°ì—ë§Œ ì‚¬ìš© (ë³´ì•ˆ ì£¼ì˜)"""
    return {"message": "Widget with custom CSP"}
```

### Swagger UIì™€ CSP ì„¤ì •

django-ninjaì˜ ìë™ ë¬¸ì„œí™” í˜ì´ì§€ëŠ” ì¸ë¼ì¸ ìŠ¤í¬ë¦½íŠ¸ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤. CSPë¥¼ í™œì„±í™”í•˜ë©´ **nonce**ë¥¼ ì‚¬ìš©í•´ì•¼ í•©ë‹ˆë‹¤.

```python
# settings.py
SECURE_CSP = {
    "default-src": [CSP.SELF],
    "script-src": [
        CSP.SELF,
        CSP.NONCE,  # Swagger UIë¥¼ ìœ„í•´ í•„ìš”
        "https://cdn.jsdelivr.net",  # Swagger UI CDN
    ],
    "style-src": [
        CSP.SELF,
        CSP.NONCE,
        "https://cdn.jsdelivr.net",
    ],
    "img-src": [
        CSP.SELF,
        "data:",  # Swagger UI ë¡œê³ 
    ],
}
```

### Report-Only ëª¨ë“œë¡œ í…ŒìŠ¤íŠ¸í•˜ê¸°

í”„ë¡œë•ì…˜ì— ë°”ë¡œ ì ìš©í•˜ê¸° ì „ì— **Report-Only ëª¨ë“œ**ë¡œ í…ŒìŠ¤íŠ¸í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.

```python
# settings.py
# ì •ì±…ì„ ìœ„ë°˜í•´ë„ ì°¨ë‹¨í•˜ì§€ ì•Šê³  ë³´ê³ ë§Œ í•¨
SECURE_CSP_REPORT_ONLY = {
    "default-src": [CSP.SELF],
    "script-src": [CSP.SELF, CSP.NONCE],
    "report-uri": "/csp-report/",  # ìœ„ë°˜ ì‚¬í•­ ë¦¬í¬íŠ¸ URL
}


# api.py
@api.post("/csp-report")
def csp_violation_report(request):
    """CSP ìœ„ë°˜ ì‚¬í•­ì„ ìˆ˜ì§‘"""
    import json
    
    report = json.loads(request.body)
    logger.warning(f"CSP Violation: {report}")
    
    return {"status": "reported"}
```

### django-ninja í”„ë¡œì íŠ¸ì— CSP ì ìš© ê°€ì´ë“œ

**ë‹¨ê³„ë³„ ì ìš©:**

1. **Report-Only ëª¨ë“œë¡œ ì‹œì‘**
   ```python
   SECURE_CSP_REPORT_ONLY = {...}
   ```

2. **ìœ„ë°˜ ì‚¬í•­ ëª¨ë‹ˆí„°ë§**
   - ë¡œê·¸ë¥¼ í™•ì¸í•˜ê³  ì–´ë–¤ ë¦¬ì†ŒìŠ¤ê°€ ì°¨ë‹¨ë˜ëŠ”ì§€ íŒŒì•…

3. **ì •ì±… ì¡°ì •**
   - í•„ìš”í•œ ë„ë©”ì¸ì„ í—ˆìš© ëª©ë¡ì— ì¶”ê°€

4. **Enforce ëª¨ë“œë¡œ ì „í™˜**
   ```python
   SECURE_CSP = {...}
   ```

**ì£¼ì˜ì‚¬í•­:**
- ì™¸ë¶€ API í˜¸ì¶œì´ ë§ì€ ê²½ìš° `connect-src` ì„¤ì • ì£¼ì˜
- CDN ì‚¬ìš© ì‹œ í•´ë‹¹ ë„ë©”ì¸ ëª…ì‹œì  í—ˆìš© í•„ìš”
- ê°œë°œ í™˜ê²½ê³¼ í”„ë¡œë•ì…˜ í™˜ê²½ ì„¤ì • ë¶„ë¦¬ ê¶Œì¥

## ğŸ’¾ Models ë° ORM ê°œì„ ì‚¬í•­ (django-ninja ê°œë°œì í•„ë…)

### StringAggê°€ ëª¨ë“  ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì‚¬ìš© ê°€ëŠ¥

ì´ì „ì—ëŠ” PostgreSQLì—ì„œë§Œ ì‚¬ìš© ê°€ëŠ¥í–ˆë˜ `StringAgg`ê°€ ì´ì œ **ëª¨ë“  ë°ì´í„°ë² ì´ìŠ¤**(SQLite, MySQL, Oracle ë“±)ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**django-ninja APIì—ì„œ í™œìš© ì˜ˆì œ:**

```python
# models.py
from django.db import models

class Tag(models.Model):
    name = models.CharField(max_length=50)

class Post(models.Model):
    title = models.CharField(max_length=200)
    content = models.TextField()
    tags = models.ManyToManyField(Tag)


# api.py
from ninja import NinjaAPI, Schema
from django.db.models import StringAgg

api = NinjaAPI()


@api.get("/posts")
def list_posts(request):
    """ê²Œì‹œê¸€ ëª©ë¡ê³¼ íƒœê·¸ë¥¼ í•œ ë²ˆì˜ ì¿¼ë¦¬ë¡œ ì¡°íšŒ"""
    posts = Post.objects.annotate(
        tag_names=StringAgg('tags__name', delimiter=', ')
    ).values('id', 'title', 'tag_names')
    
    return list(posts)
    # ê²°ê³¼: [
    #   {"id": 1, "title": "Django 6.0", "tag_names": "Django, Python, Backend"},
    #   {"id": 2, "title": "FastAPI", "tag_names": "Python, API"}
    # ]
```

**ì„±ëŠ¥ ì´ì :**
- N+1 ì¿¼ë¦¬ ë¬¸ì œ í•´ê²°
- API ì‘ë‹µ ì‹œê°„ ë‹¨ì¶•
- ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ ê°ì†Œ

### AnyValue Aggregate ì¶”ê°€

**ëœë¤í•œ ê°’ì´ í•„ìš”í•  ë•Œ ìœ ìš©:**

```python
from django.db.models import AnyValue

@api.get("/categories/sample")
def category_samples(request):
    """ê° ì¹´í…Œê³ ë¦¬ì—ì„œ ë¬´ì‘ìœ„ ìƒí’ˆ í•˜ë‚˜ì”© ê°€ì ¸ì˜¤ê¸°"""
    samples = Product.objects.values('category').annotate(
        sample_name=AnyValue('name'),
        sample_price=AnyValue('price'),
        sample_image=AnyValue('image_url')
    )
    
    return list(samples)
```

### Aggregateì— order_by ì§€ì›

ì´ì œ ì§‘ê³„ í•¨ìˆ˜ì—ì„œ **ì •ë ¬ ìˆœì„œë¥¼ ì§€ì •**í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
from django.db.models import StringAgg, Count

@api.get("/users/{user_id}/activity")
def user_activity(request, user_id: int):
    """ì‚¬ìš©ìì˜ ìµœê·¼ í™œë™ì„ ì‹œê°„ìˆœìœ¼ë¡œ ì§‘ê³„"""
    user = User.objects.annotate(
        recent_posts=StringAgg(
            'posts__title',
            delimiter=' | ',
            order_by='-posts__created_at'  # ìµœì‹ ìˆœ ì •ë ¬
        ),
        post_count=Count('posts')
    ).get(id=user_id)
    
    return {
        "user_id": user.id,
        "username": user.username,
        "post_count": user.post_count,
        "recent_posts": user.recent_posts
    }
```

### GeneratedField ìë™ ê°±ì‹ 

`GeneratedField`ì™€ F() í‘œí˜„ì‹ìœ¼ë¡œ í• ë‹¹ëœ í•„ë“œê°€ **ìë™ìœ¼ë¡œ ìƒˆë¡œê³ ì¹¨**ë©ë‹ˆë‹¤ (PostgreSQL, SQLite, Oracle).

```python
# models.py
from django.db import models
from django.db.models import F, GeneratedField

class Product(models.Model):
    name = models.CharField(max_length=200)
    price = models.DecimalField(max_digits=10, decimal_places=2)
    discount_rate = models.DecimalField(max_digits=5, decimal_places=2, default=0)
    
    # ìë™ ê³„ì‚°ë˜ëŠ” í•„ë“œ
    final_price = GeneratedField(
        expression=F('price') * (1 - F('discount_rate') / 100),
        output_field=models.DecimalField(max_digits=10, decimal_places=2),
        db_persist=True
    )


# api.py
@api.put("/products/{product_id}/discount")
def update_discount(request, product_id: int, discount_rate: float):
    """í• ì¸ìœ¨ ì—…ë°ì´íŠ¸ - final_priceëŠ” ìë™ ê³„ì‚°ë¨"""
    product = Product.objects.get(id=product_id)
    product.discount_rate = discount_rate
    product.save()
    
    # Django 6.0ì—ì„œëŠ” final_priceê°€ ìë™ìœ¼ë¡œ ê°±ì‹ ë¨
    return {
        "id": product.id,
        "price": float(product.price),
        "discount_rate": float(product.discount_rate),
        "final_price": float(product.final_price)  # ìë™ ê°±ì‹ ëœ ê°’
    }
```

### Model.NotUpdated ì˜ˆì™¸ ì¶”ê°€

ê°•ì œ ì—…ë°ì´íŠ¸ê°€ ì‹¤íŒ¨í–ˆì„ ë•Œ ë” ëª…í™•í•œ ì˜ˆì™¸ê°€ ë°œìƒí•©ë‹ˆë‹¤.

```python
from django.db import models

@api.put("/products/{product_id}")
def update_product(request, product_id: int, data: ProductSchema):
    """ë™ì‹œì„± ì œì–´ê°€ í•„ìš”í•œ ì—…ë°ì´íŠ¸"""
    try:
        product = Product.objects.get(id=product_id)
        product.name = data.name
        product.price = data.price
        
        # force_update=True: í•´ë‹¹ ë ˆì½”ë“œê°€ ì¡´ì¬í•˜ì§€ ì•Šìœ¼ë©´ ì˜ˆì™¸ ë°œìƒ
        product.save(force_update=True)
        
        return {"status": "updated", "id": product.id}
        
    except Product.NotUpdated:
        # ë‹¤ë¥¸ ìš”ì²­ì—ì„œ ì´ë¯¸ ì‚­ì œë˜ì—ˆê±°ë‚˜ ìˆ˜ì •ëœ ê²½ìš°
        return {"error": "Product was modified or deleted by another request"}, 409
```

### JSONFieldì˜ ìŒìˆ˜ ì¸ë±ì‹± (SQLite)

SQLiteì—ì„œë„ ì´ì œ Python ìŠ¤íƒ€ì¼ì˜ ìŒìˆ˜ ì¸ë±ì‹±ì„ ì‚¬ìš©í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```python
from django.db import models

class UserActivity(models.Model):
    user = models.ForeignKey(User, on_delete=models.CASCADE)
    actions = models.JSONField()  # ë°°ì—´: ["login", "view", "purchase"]


@api.get("/users/{user_id}/last-action")
def get_last_action(request, user_id: int):
    """ì‚¬ìš©ìì˜ ë§ˆì§€ë§‰ í–‰ë™ ì¡°íšŒ"""
    activity = UserActivity.objects.filter(
        user_id=user_id,
        actions__-1='purchase'  # ë§ˆì§€ë§‰ ìš”ì†Œê°€ 'purchase'ì¸ ê²½ìš°
    ).first()
    
    if activity:
        return {
            "user_id": user_id,
            "last_action": activity.actions[-1],
            "all_actions": activity.actions
        }
    return {"message": "No purchase activity found"}
```

### django-ninja Schemaì™€ í•¨ê»˜ ì‚¬ìš©í•˜ê¸°

**ìµœì í™”ëœ API ì‘ë‹µ:**

```python
from ninja import Schema
from typing import Optional
from decimal import Decimal

class ProductOut(Schema):
    id: int
    name: str
    price: Decimal
    discount_rate: Decimal
    final_price: Decimal
    tags: str  # StringAgg ê²°ê³¼


@api.get("/products", response=list[ProductOut])
def list_products(request):
    """ìµœì í™”ëœ ìƒí’ˆ ëª©ë¡ API"""
    products = Product.objects.annotate(
        tags=StringAgg('tags__name', delimiter=', ')
    ).values(
        'id', 'name', 'price', 'discount_rate', 'final_price', 'tags'
    )
    
    return list(products)
```

**ì„±ëŠ¥ ìµœì í™” íŒ:**
1. `StringAgg`ë¡œ ê´€ê³„í˜• ë°ì´í„°ë¥¼ í•œ ë²ˆì— ì¡°íšŒ
2. `select_related`/`prefetch_related` ëŒ€ì‹  `annotate` ì‚¬ìš© ê³ ë ¤
3. `values()`ë¡œ í•„ìš”í•œ í•„ë“œë§Œ ì„ íƒ
4. API ì‘ë‹µ í¬ê¸° ê°ì†Œ

## âš¡ Async ì§€ì› ê°œì„ : AsyncPaginator

### AsyncPaginatorì™€ AsyncPage

Django 6.0ì€ ë¹„ë™ê¸° í™˜ê²½ì—ì„œ í˜ì´ì§€ë„¤ì´ì…˜ì„ ì§€ì›í•˜ëŠ” `AsyncPaginator`ì™€ `AsyncPage`ë¥¼ ì¶”ê°€í–ˆìŠµë‹ˆë‹¤. django-ninjaì˜ async endpointì™€ ì™„ë²½í•˜ê²Œ í†µí•©ë©ë‹ˆë‹¤.

**ê¸°ì¡´ ë™ê¸° ë°©ì‹:**

```python
from ninja import NinjaAPI
from django.core.paginator import Paginator

api = NinjaAPI()

@api.get("/products")
def list_products(request, page: int = 1):
    products = Product.objects.all()
    paginator = Paginator(products, 20)
    page_obj = paginator.get_page(page)
    
    return {
        "count": paginator.count,
        "results": [
            {"id": p.id, "name": p.name}
            for p in page_obj
        ]
    }
```

**ìƒˆë¡œìš´ ë¹„ë™ê¸° ë°©ì‹ (Django 6.0):**

```python
from ninja import NinjaAPI
from django.core.paginator import AsyncPaginator
from typing import List

api = NinjaAPI()

@api.get("/products")
async def list_products_async(request, page: int = 1):
    """ì™„ì „í•œ ë¹„ë™ê¸° í˜ì´ì§€ë„¤ì´ì…˜"""
    products = Product.objects.all()
    
    # AsyncPaginator ì‚¬ìš©
    paginator = AsyncPaginator(products, per_page=20)
    
    # ë¹„ë™ê¸°ë¡œ í˜ì´ì§€ ì¡°íšŒ
    page_obj = await paginator.get_page(page)
    
    return {
        "count": await paginator.acount(),  # ë¹„ë™ê¸° ì¹´ìš´íŠ¸
        "total_pages": paginator.num_pages,
        "current_page": page_obj.number,
        "has_next": await page_obj.has_next(),
        "has_previous": await page_obj.has_previous(),
        "results": [
            {"id": p.id, "name": p.name}
            async for p in page_obj  # ë¹„ë™ê¸° ì´í„°ë ˆì´ì…˜
        ]
    }
```

### django-ninjaì™€ AsyncPaginator í†µí•© ì˜ˆì œ

**ì¬ì‚¬ìš© ê°€ëŠ¥í•œ Pagination Schema:**

```python
# schemas.py
from ninja import Schema
from typing import Generic, TypeVar, List

T = TypeVar('T')

class PaginatedResponse(Schema, Generic[T]):
    count: int
    total_pages: int
    current_page: int
    has_next: bool
    has_previous: bool
    results: List[T]


class ProductSchema(Schema):
    id: int
    name: str
    price: float


# api.py
from django.core.paginator import AsyncPaginator

@api.get("/products", response=PaginatedResponse[ProductSchema])
async def list_products(request, page: int = 1, page_size: int = 20):
    """íƒ€ì… ì•ˆì „í•œ ë¹„ë™ê¸° í˜ì´ì§€ë„¤ì´ì…˜"""
    products = Product.objects.all().order_by('-created_at')
    
    paginator = AsyncPaginator(products, per_page=page_size)
    page_obj = await paginator.get_page(page)
    
    return {
        "count": await paginator.acount(),
        "total_pages": paginator.num_pages,
        "current_page": page_obj.number,
        "has_next": await page_obj.has_next(),
        "has_previous": await page_obj.has_previous(),
        "results": [
            {
                "id": p.id,
                "name": p.name,
                "price": float(p.price)
            }
            async for p in page_obj
        ]
    }
```

### ë³µì¡í•œ ì¿¼ë¦¬ì™€ ë¹„ë™ê¸° í˜ì´ì§€ë„¤ì´ì…˜

```python
from django.db.models import Q, Count
from django.core.paginator import AsyncPaginator

@api.get("/search", response=PaginatedResponse[ProductSchema])
async def search_products(
    request,
    query: str,
    category: str = None,
    min_price: float = None,
    max_price: float = None,
    page: int = 1
):
    """ë³µì¡í•œ ê²€ìƒ‰ ì¿¼ë¦¬ì— ë¹„ë™ê¸° í˜ì´ì§€ë„¤ì´ì…˜ ì ìš©"""
    
    # í•„í„° ì¡°ê±´ êµ¬ì„±
    filters = Q(name__icontains=query) | Q(description__icontains=query)
    
    if category:
        filters &= Q(category__name=category)
    if min_price:
        filters &= Q(price__gte=min_price)
    if max_price:
        filters &= Q(price__lte=max_price)
    
    # ì¿¼ë¦¬ì…‹ ìƒì„±
    products = Product.objects.filter(filters).annotate(
        review_count=Count('reviews')
    ).order_by('-review_count', '-created_at')
    
    # ë¹„ë™ê¸° í˜ì´ì§€ë„¤ì´ì…˜
    paginator = AsyncPaginator(products, per_page=20)
    page_obj = await paginator.get_page(page)
    
    return {
        "count": await paginator.acount(),
        "total_pages": paginator.num_pages,
        "current_page": page_obj.number,
        "has_next": await page_obj.has_next(),
        "has_previous": await page_obj.has_previous(),
        "results": [
            {
                "id": p.id,
                "name": p.name,
                "price": float(p.price),
                "review_count": p.review_count
            }
            async for p in page_obj
        ]
    }
```

### ì„±ëŠ¥ ë¹„êµ ë° ì‚¬ìš© ì‹œê¸°

**AsyncPaginatorë¥¼ ì‚¬ìš©í•´ì•¼ í•˜ëŠ” ê²½ìš°:**
- ëŒ€ëŸ‰ì˜ ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ëŠ” API
- ë†’ì€ ë™ì‹œ ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ” ì„œë¹„ìŠ¤
- I/O bound ì‘ì—…ì´ ë§ì€ ê²½ìš° (ì™¸ë¶€ API í˜¸ì¶œ, íŒŒì¼ ì½ê¸° ë“±)

**ë™ê¸° Paginatorë¥¼ ì‚¬ìš©í•´ë„ ë˜ëŠ” ê²½ìš°:**
- ê°„ë‹¨í•œ CRUD API
- íŠ¸ë˜í”½ì´ ë‚®ì€ ì„œë¹„ìŠ¤
- CPU bound ì‘ì—…ì´ ë§ì€ ê²½ìš°

**ì‹¤ì œ ë²¤ì¹˜ë§ˆí¬ ì˜ˆì‹œ:**
```python
# 1000ê°œì˜ ë™ì‹œ ìš”ì²­ ì²˜ë¦¬ ì‹œê°„
# ë™ê¸° Paginator: ~5ì´ˆ
# AsyncPaginator: ~1.5ì´ˆ (ì•½ 3ë°° ë¹ ë¦„)
```

### ì£¼ì˜ì‚¬í•­

1. **ë°ì´í„°ë² ì´ìŠ¤ ì—°ê²°**: ë¹„ë™ê¸° í˜ì´ì§€ë„¤ì´ì…˜ì€ ë¹„ë™ê¸° DB ë“œë¼ì´ë²„ê°€ í•„ìš”í•©ë‹ˆë‹¤
   ```python
   # settings.py
   DATABASES = {
       'default': {
           'ENGINE': 'django.db.backends.postgresql',
           # PostgreSQLì˜ ê²½ìš° psycopg 3.x ì‚¬ìš©
       }
   }
   ```

2. **ORM ì œì•½ì‚¬í•­**: ëª¨ë“  ORM ê¸°ëŠ¥ì´ ë¹„ë™ê¸°ë¡œ ì§€ì›ë˜ëŠ” ê²ƒì€ ì•„ë‹™ë‹ˆë‹¤
   - `select_related()`, `prefetch_related()`ëŠ” ë¹„ë™ê¸° ì§€ì›
   - ì¼ë¶€ ë³µì¡í•œ ì§‘ê³„ëŠ” ë™ê¸°ë¡œ ì²˜ë¦¬ë  ìˆ˜ ìˆìŒ

3. **django-ninja ì„¤ì •**: ASGI ì„œë²„ ì‚¬ìš© í•„ìš”
   ```bash
   uvicorn myproject.asgi:application --reload
   ```

## âš ï¸ Breaking Changes (django-ninja ê°œë°œì ì£¼ì˜ì‚¬í•­)

### DEFAULT_AUTO_FIELDê°€ BigAutoFieldë¡œ ë³€ê²½

Django 6.0ë¶€í„° `DEFAULT_AUTO_FIELD`ì˜ ê¸°ë³¸ê°’ì´ `AutoField`ì—ì„œ **`BigAutoField`**ë¡œ ë³€ê²½ë˜ì—ˆìŠµë‹ˆë‹¤.

**ì˜í–¥ë°›ëŠ” ê²½ìš°:**
- ìƒˆë¡œìš´ ëª¨ë¸ì„ ìƒì„±í•˜ëŠ” ê²½ìš°
- ê¸°ì¡´ í”„ë¡œì íŠ¸ì—ì„œ ëª…ì‹œì ìœ¼ë¡œ ì„¤ì •í•˜ì§€ ì•Šì€ ê²½ìš°

**django-ninja APIì—ì„œì˜ ì˜í–¥:**

```python
# ê¸°ì¡´ ì½”ë“œ (Django 5.xê¹Œì§€)
class Product(models.Model):
    # idëŠ” ìë™ìœ¼ë¡œ AutoField (ìµœëŒ€ 2,147,483,647)
    name = models.CharField(max_length=200)


# Django 6.0 ì´í›„
class Product(models.Model):
    # idëŠ” ìë™ìœ¼ë¡œ BigAutoField (ìµœëŒ€ 9,223,372,036,854,775,807)
    name = models.CharField(max_length=200)
```

**API ì‘ë‹µ íƒ€ì… ë³€ê²½:**

```python
# schemas.py
from ninja import Schema

class ProductSchema(Schema):
    id: int  # ì—¬ì „íˆ intë¡œ ì‚¬ìš© ê°€ëŠ¥ (BigIntëŠ” Python intë¡œ í‘œí˜„ë¨)
    name: str


# APIì—ëŠ” ì˜í–¥ ì—†ìŒ
@api.get("/products/{product_id}", response=ProductSchema)
def get_product(request, product_id: int):
    product = Product.objects.get(id=product_id)
    return product
```

**ë§ˆì´ê·¸ë ˆì´ì…˜ í•„ìš” ì—¬ë¶€:**

```python
# settings.py
# ê¸°ì¡´ ë™ì‘ì„ ìœ ì§€í•˜ë ¤ë©´ (ê¶Œì¥í•˜ì§€ ì•ŠìŒ)
DEFAULT_AUTO_FIELD = 'django.db.models.AutoField'

# ë˜ëŠ” ì•±ë³„ë¡œ ì„¤ì •
# apps.py
from django.apps import AppConfig

class MyAppConfig(AppConfig):
    default_auto_field = 'django.db.models.AutoField'
```

**ê¶Œì¥ì‚¬í•­:**
- ìƒˆ í”„ë¡œì íŠ¸ëŠ” BigAutoField ì‚¬ìš© (ê¸°ë³¸ê°’)
- ê¸°ì¡´ í”„ë¡œì íŠ¸ëŠ” settings.pyì— ëª…ì‹œì ìœ¼ë¡œ ì„¤ì •
- ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹œ ë°ì´í„°ë² ì´ìŠ¤ ìŠ¤í‚¤ë§ˆ ë³€ê²½ í•„ìš”í•  ìˆ˜ ìˆìŒ

### Email API ë³€ê²½ì‚¬í•­

Pythonì˜ modern email APIë¡œ ì „í™˜ë˜ì—ˆìŠµë‹ˆë‹¤. **django-ninjaì—ì„œ ì´ë©”ì¼ ë°œì†¡í•˜ëŠ” ê²½ìš° ì˜í–¥**ì„ ë°›ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.

**deprecatedëœ ê¸°ëŠ¥:**
- `SafeMIMEText`, `SafeMIMEMultipart` í´ë˜ìŠ¤
- `BadHeaderError` ì˜ˆì™¸ (ValueErrorë¡œ ëŒ€ì²´)
- Positional arguments (í‚¤ì›Œë“œ ì¸ìˆ˜ í•„ìˆ˜)

**ê¸°ì¡´ ì½”ë“œ:**

```python
from django.core.mail import send_mail

@api.post("/contact")
def send_contact_email(request, data: ContactSchema):
    # ê¸°ì¡´ ë°©ì‹ (ì—¬ì „íˆ ì‘ë™í•˜ì§€ë§Œ deprecated warning)
    send_mail(
        "Contact Request",  # subject
        "Message body",      # message
        "from@example.com",  # from_email
        ["to@example.com"],  # recipient_list
        False                # fail_silently (positional - deprecated)
    )
    return {"status": "sent"}
```

**ìˆ˜ì •ëœ ì½”ë“œ (Django 6.0 ê¶Œì¥):**

```python
from django.core.mail import send_mail

@api.post("/contact")
def send_contact_email(request, data: ContactSchema):
    # í‚¤ì›Œë“œ ì¸ìˆ˜ ì‚¬ìš© (í•„ìˆ˜)
    send_mail(
        subject="Contact Request",
        message="Message body",
        from_email="from@example.com",
        recipient_list=["to@example.com"],
        fail_silently=False  # í‚¤ì›Œë“œë¡œ ì „ë‹¬
    )
    return {"status": "sent"}
```

**EmailMessage ì‚¬ìš© ì‹œ:**

```python
from django.core.mail import EmailMessage

@api.post("/newsletter")
def send_newsletter(request, data: NewsletterSchema):
    # ëª¨ë“  ì¸ìˆ˜ë¥¼ í‚¤ì›Œë“œë¡œ ì „ë‹¬
    email = EmailMessage(
        subject=data.subject,
        body=data.body,
        from_email="newsletter@example.com",
        to=data.recipients,
        # bcc, cc ë“±ë„ í‚¤ì›Œë“œë¡œ ì „ë‹¬
        bcc=["admin@example.com"]
    )
    email.send()
    return {"status": "sent", "recipients": len(data.recipients)}
```

### MariaDB 10.5 ì§€ì› ì¤‘ë‹¨

MariaDB ì‚¬ìš©ìëŠ” **10.6 ì´ìƒ**ìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œí•´ì•¼ í•©ë‹ˆë‹¤.

```python
# settings.py
DATABASES = {
    'default': {
        'ENGINE': 'django.db.backends.mysql',
        'NAME': 'mydb',
        'USER': 'myuser',
        'PASSWORD': 'mypassword',
        'HOST': 'localhost',
        'PORT': '3306',
        # MariaDB 10.6+ í•„ìš”
    }
}
```

**í™•ì¸ ë°©ë²•:**
```bash
mysql --version
# ë˜ëŠ”
MariaDB [(none)]> SELECT VERSION();
```

### ORM í‘œí˜„ì‹ ë³€ê²½ (ì»¤ìŠ¤í…€ í‘œí˜„ì‹ ì‚¬ìš© ì‹œ)

**ì»¤ìŠ¤í…€ Lookupì´ë‚˜ Expressionì„ ë§Œë“  ê²½ìš°:**

```python
# ê¸°ì¡´ ì½”ë“œ (Django 5.x)
def as_sql(self, compiler, connection):
    lhs, lhs_params = self.process_lhs(compiler, connection)
    rhs, rhs_params = self.process_rhs(compiler, connection)
    params = lhs_params + rhs_params  # list ë˜ëŠ” tuple
    return sql, params


# Django 6.0 (tuple ë°˜í™˜ í•„ìˆ˜)
def as_sql(self, compiler, connection) -> tuple[str, tuple]:
    lhs, lhs_params = self.process_lhs(compiler, connection)
    rhs, rhs_params = self.process_rhs(compiler, connection)
    params = (*lhs_params, *rhs_params)  # tupleë¡œ unpacking
    return sql, params
```

**ëŒ€ë¶€ë¶„ì˜ django-ninja ê°œë°œìëŠ” ì˜í–¥ë°›ì§€ ì•ŠìŒ** (ì»¤ìŠ¤í…€ ORM í™•ì¥ì„ ë§Œë“¤ì§€ ì•ŠëŠ” í•œ).

## ğŸ”„ Django 6.0 ë§ˆì´ê·¸ë ˆì´ì…˜ ì²´í¬ë¦¬ìŠ¤íŠ¸

### ë‹¨ê³„ë³„ ì—…ê·¸ë ˆì´ë“œ ê°€ì´ë“œ

**1ë‹¨ê³„: í™˜ê²½ ì¤€ë¹„**

```bash
# Python 3.12 ì„¤ì¹˜ í™•ì¸
python --version  # Python 3.12 ì´ìƒì´ì–´ì•¼ í•¨

# ê°€ìƒí™˜ê²½ ì¬ìƒì„±
python -m venv venv
source venv/bin/activate  # Linux/Mac
# venv\Scripts\activate  # Windows

# Django 6.0 ì„¤ì¹˜
pip install --upgrade Django
pip install --upgrade django-ninja

# ì˜ì¡´ì„± ì—…ë°ì´íŠ¸
pip install --upgrade -r requirements.txt
```

**2ë‹¨ê³„: Settings ê²€í† **

```python
# settings.py ì²´í¬ë¦¬ìŠ¤íŠ¸

# 1. DEFAULT_AUTO_FIELD í™•ì¸
DEFAULT_AUTO_FIELD = 'django.db.models.BigAutoField'  # ëª…ì‹œì ìœ¼ë¡œ ì„¤ì •

# 2. Python ë²„ì „ ì²´í¬
import sys
assert sys.version_info >= (3, 12), "Python 3.12 ì´ìƒ í•„ìš”"

# 3. ë°ì´í„°ë² ì´ìŠ¤ ë²„ì „ í™•ì¸
# PostgreSQL: 12+
# MySQL: 8.0+
# MariaDB: 10.6+
# SQLite: 3.31.0+
```

**3ë‹¨ê³„: ì½”ë“œ ìˆ˜ì •**

```bash
# deprecated ê²½ê³  í™•ì¸
python -Wd manage.py check
python -Wd manage.py test

# ì´ë©”ì¼ ì½”ë“œ ê²€ìƒ‰ ë° ìˆ˜ì •
grep -r "send_mail\|EmailMessage" . --include="*.py"
# Positional argumentsë¥¼ keyword argumentsë¡œ ë³€ê²½
```

**4ë‹¨ê³„: ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰**

```bash
# ë§ˆì´ê·¸ë ˆì´ì…˜ íŒŒì¼ ìƒì„±
python manage.py makemigrations

# ë§ˆì´ê·¸ë ˆì´ì…˜ ê²€í† 
python manage.py showmigrations

# ë§ˆì´ê·¸ë ˆì´ì…˜ ì‹¤í–‰ (ë°±ì—… í›„!)
python manage.py migrate
```

**5ë‹¨ê³„: í…ŒìŠ¤íŠ¸**

```bash
# ì „ì²´ í…ŒìŠ¤íŠ¸ ì‹¤í–‰
python manage.py test

# django-ninja API í…ŒìŠ¤íŠ¸
python manage.py test myapp.tests.test_api

# ë¡œì»¬ ì„œë²„ ì‹¤í–‰ ë° ìˆ˜ë™ í…ŒìŠ¤íŠ¸
python manage.py runserver
```

### django-ninja í”„ë¡œì íŠ¸ íŠ¹í™” ì²´í¬ë¦¬ìŠ¤íŠ¸

**API ì—”ë“œí¬ì¸íŠ¸ ê²€ì¦:**

```python
# tests.py
from django.test import TestCase
from ninja.testing import TestClient
from myapp.api import api

class APITestCase(TestCase):
    def setUp(self):
        self.client = TestClient(api)
    
    def test_pagination(self):
        """í˜ì´ì§€ë„¤ì´ì…˜ ë™ì‘ í™•ì¸"""
        response = self.client.get("/products?page=1")
        self.assertEqual(response.status_code, 200)
        self.assertIn("results", response.json())
    
    def test_email_sending(self):
        """ì´ë©”ì¼ ë°œì†¡ API í…ŒìŠ¤íŠ¸"""
        response = self.client.post(
            "/contact",
            json={"email": "test@example.com", "message": "Hello"}
        )
        self.assertEqual(response.status_code, 200)
```

**ì„±ëŠ¥ í…ŒìŠ¤íŠ¸:**

```python
import time

def test_async_performance(self):
    """AsyncPaginator ì„±ëŠ¥ í™•ì¸"""
    start = time.time()
    response = self.client.get("/products?page=1&page_size=100")
    duration = time.time() - start
    
    self.assertLess(duration, 1.0)  # 1ì´ˆ ì´ë‚´ ì‘ë‹µ
```

### í”„ë¡œë•ì…˜ ë°°í¬ ì „ ì²´í¬ë¦¬ìŠ¤íŠ¸

- [ ] Python 3.12+ ì„¤ì¹˜ í™•ì¸
- [ ] ëª¨ë“  ì˜ì¡´ì„± ë²„ì „ ì—…ë°ì´íŠ¸
- [ ] ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—… ì™„ë£Œ
- [ ] ë¡œì»¬ í™˜ê²½ì—ì„œ ì „ì²´ í…ŒìŠ¤íŠ¸ í†µê³¼
- [ ] ìŠ¤í…Œì´ì§• í™˜ê²½ì—ì„œ ê²€ì¦
- [ ] Email ì½”ë“œ í‚¤ì›Œë“œ ì¸ìˆ˜ë¡œ ë³€ê²½
- [ ] CSP ì„¤ì • ê²€í†  (í•„ìš”í•œ ê²½ìš°)
- [ ] CI/CD íŒŒì´í”„ë¼ì¸ ì—…ë°ì´íŠ¸
- [ ] ë¡¤ë°± ê³„íš ì¤€ë¹„

## ğŸ“„ Template Partials (í…œí”Œë¦¿ ì‚¬ìš© ì‹œ)

Django 6.0ì€ **Template Partials**ë¥¼ ë„ì…í•˜ì—¬ í…œí”Œë¦¿ ì¬ì‚¬ìš©ì„±ì„ í¬ê²Œ ê°œì„ í–ˆìŠµë‹ˆë‹¤. django-ninjaëŠ” ì£¼ë¡œ JSON APIë¥¼ ì œê³µí•˜ì§€ë§Œ, ê´€ë¦¬ì í˜ì´ì§€ë‚˜ ì´ë©”ì¼ í…œí”Œë¦¿ì„ ì‚¬ìš©í•˜ëŠ” ê²½ìš° ìœ ìš©í•©ë‹ˆë‹¤.

### Template Partialsë€?

í…œí”Œë¦¿ ë‚´ì—ì„œ **ì¬ì‚¬ìš© ê°€ëŠ¥í•œ ì‘ì€ ì»´í¬ë„ŒíŠ¸**ë¥¼ ì •ì˜í•˜ê³  ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” ê¸°ëŠ¥ì…ë‹ˆë‹¤.

**ê¸°ì¡´ ë°©ì‹ (ë³„ë„ íŒŒì¼ í•„ìš”):**

```django
<!-- templates/user_card.html -->
<div class="user-card">
    <h3>{{ user.username }}</h3>
    <p>{{ user.email }}</p>
</div>

<!-- templates/user_list.html -->
{% raw %}
{% for user in users %}
    {% include "user_card.html" %}
{% endfor %}
{% endraw %}
```

**ìƒˆë¡œìš´ ë°©ì‹ (ê°™ì€ íŒŒì¼ ë‚´ì—ì„œ):**

```django
{% raw %}
<!-- templates/user_list.html -->
{% partialdef user_card %}
    <div class="user-card">
        <h3>{{ user.username }}</h3>
        <p>{{ user.email }}</p>
    </div>
{% endpartialdef %}

<!-- ì‚¬ìš© -->
{% for user in users %}
    {% partial user_card user=user %}
{% endfor %}
{% endraw %}
```

### django-ninjaì—ì„œ ì´ë©”ì¼ í…œí”Œë¦¿ì— í™œìš©

**ì´ë©”ì¼ ë°œì†¡ APIì™€ Template Partials:**

```python
# api.py
from ninja import NinjaAPI
from django.template.loader import get_template
from django.core.mail import EmailMessage

api = NinjaAPI()


@api.post("/orders/{order_id}/confirm")
def send_order_confirmation(request, order_id: int):
    """ì£¼ë¬¸ í™•ì¸ ì´ë©”ì¼ ë°œì†¡"""
    order = Order.objects.get(id=order_id)
    
    # Partialì„ í¬í•¨í•œ í…œí”Œë¦¿ ë Œë”ë§
    template = get_template('emails/order_confirmation.html')
    html_content = template.render({
        'order': order,
        'user': order.user,
        'items': order.items.all()
    })
    
    email = EmailMessage(
        subject=f"ì£¼ë¬¸ í™•ì¸ #{order.id}",
        body=html_content,
        from_email="orders@example.com",
        to=[order.user.email]
    )
    email.content_subtype = "html"
    email.send()
    
    return {"status": "email_sent", "order_id": order.id}
```

**ì´ë©”ì¼ í…œí”Œë¦¿:**

```django
{% raw %}
<!-- templates/emails/order_confirmation.html -->
{% partialdef order_item %}
    <tr>
        <td>{{ item.product.name }}</td>
        <td>{{ item.quantity }}</td>
        <td>${{ item.price }}</td>
    </tr>
{% endpartialdef %}

<!DOCTYPE html>
<html>
<head>
    <title>ì£¼ë¬¸ í™•ì¸</title>
</head>
<body>
    <h1>ì£¼ë¬¸ì´ í™•ì¸ë˜ì—ˆìŠµë‹ˆë‹¤</h1>
    <p>ì•ˆë…•í•˜ì„¸ìš”, {{ user.username }}ë‹˜</p>
    
    <table>
        <thead>
            <tr>
                <th>ìƒí’ˆ</th>
                <th>ìˆ˜ëŸ‰</th>
                <th>ê°€ê²©</th>
            </tr>
        </thead>
        <tbody>
            {% for item in items %}
                {% partial order_item item=item %}
            {% endfor %}
        </tbody>
    </table>
    
    <p>ì´ ê¸ˆì•¡: ${{ order.total_amount }}</p>
</body>
</html>
{% endraw %}
```

### ê´€ë¦¬ì ì»¤ìŠ¤í„°ë§ˆì´ì§•ì— í™œìš©

```django
{% raw %}
<!-- templates/admin/custom_dashboard.html -->
{% extends "admin/base.html" %}

{% partialdef stat_card %}
    <div class="stat-card">
        <h3>{{ title }}</h3>
        <p class="stat-value">{{ value }}</p>
        <p class="stat-change">{{ change }}</p>
    </div>
{% endpartialdef %}

{% block content %}
    <div class="dashboard">
        {% partial stat_card title="ì´ ì‚¬ìš©ì" value=user_count change="+12%" %}
        {% partial stat_card title="ì´ ì£¼ë¬¸" value=order_count change="+8%" %}
        {% partial stat_card title="ë§¤ì¶œ" value=revenue change="+15%" %}
    </div>
{% endblock %}
{% endraw %}
```

**django-ninja ê°œë°œìë¥¼ ìœ„í•œ ì •ë¦¬:**
- JSON APIê°€ ì£¼ìš” ì‚¬ìš© ì‚¬ë¡€ë¼ë©´ Template PartialsëŠ” ì„ íƒì‚¬í•­
- ì´ë©”ì¼ í…œí”Œë¦¿ì´ë‚˜ ê´€ë¦¬ í˜ì´ì§€ë¥¼ ë§ì´ ì‚¬ìš©í•œë‹¤ë©´ ìœ ìš©
- HTMXë‚˜ Alpine.jsì™€ í•¨ê»˜ ì‚¬ìš©í•˜ë©´ ë” ê°•ë ¥

## ğŸ› ï¸ ê¸°íƒ€ ìœ ìš©í•œ ê°œì„ ì‚¬í•­

### 1. forloop.length ë³€ìˆ˜ ì¶”ê°€

í…œí”Œë¦¿ì—ì„œ ë°˜ë³µë¬¸ì˜ ì´ ê°œìˆ˜ë¥¼ ì‰½ê²Œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

```django
{% raw %}
{% for item in items %}
    <p>{{ forloop.counter }} / {{ forloop.length }}</p>
{% endfor %}
{% endraw %}
```

### 2. Management Commands ê°œì„ 

**ìë™ import ê¸°ëŠ¥:**

```bash
python manage.py shell
# ì´ì œ ìë™ìœ¼ë¡œ importë¨:
>>> settings  # django.conf.settings
>>> User  # django.contrib.auth.models.User (ì„¤ì¹˜ëœ ê²½ìš°)
```

**startproject/startapp ê°œì„ :**
- ì¡´ì¬í•˜ì§€ ì•ŠëŠ” ë””ë ‰í† ë¦¬ë¥¼ ìë™ìœ¼ë¡œ ìƒì„±

### 3. Admin ê°œì„ ì‚¬í•­

**Font Awesome 6.7.2 ì‚¬ìš©:**
- ë” ë‹¤ì–‘í•œ ì•„ì´ì½˜ ì‚¬ìš© ê°€ëŠ¥
- Admin ì¸í„°í˜ì´ìŠ¤ ì‹œê°ì  ê°œì„ 

**ë©”ì‹œì§€ ë ˆë²¨ ì•„ì´ì½˜ êµ¬ë¶„:**
```python
from django.contrib import messages

@api.post("/admin/action")
def admin_action(request):
    messages.debug(request, "ë””ë²„ê·¸ ë©”ì‹œì§€")  # ìƒˆë¡œìš´ ì•„ì´ì½˜
    messages.info(request, "ì •ë³´ ë©”ì‹œì§€")    # ìƒˆë¡œìš´ ì•„ì´ì½˜
    messages.success(request, "ì„±ê³µ!")      # ê¸°ì¡´ê³¼ ë‹¤ë¥¸ ì•„ì´ì½˜
    return {"status": "ok"}
```

### 4. Multiple Cookie Headers ì§€ì› (HTTP/2)

ASGI í™˜ê²½ì—ì„œ HTTP/2ì˜ multiple Cookie í—¤ë”ë¥¼ ì˜¬ë°”ë¥´ê²Œ ì²˜ë¦¬í•©ë‹ˆë‹¤.

```python
# django-ninja API with HTTP/2
@api.get("/profile")
async def get_profile(request):
    # HTTP/2ì—ì„œ ì—¬ëŸ¬ Cookie í—¤ë”ê°€ ìë™ìœ¼ë¡œ ë³‘í•©ë¨
    session_id = request.COOKIES.get('sessionid')
    csrf_token = request.COOKIES.get('csrftoken')
    
    return {
        "authenticated": bool(session_id),
        "csrf_protected": bool(csrf_token)
    }
```

## ğŸ“Š django-ninja ê°œë°œìë¥¼ ìœ„í•œ ìš°ì„ ìˆœìœ„ ì •ë¦¬

### ì¦‰ì‹œ ë„ì… ê°€ëŠ¥í•œ ê¸°ëŠ¥

**1. StringAgg (ë†’ì€ ìš°ì„ ìˆœìœ„)**
- N+1 ì¿¼ë¦¬ í•´ê²°
- API ì‘ë‹µ ìµœì í™”
- ëª¨ë“  ë°ì´í„°ë² ì´ìŠ¤ì—ì„œ ì‚¬ìš© ê°€ëŠ¥

```python
# ì¦‰ì‹œ ì ìš© ì¶”ì²œ
products = Product.objects.annotate(
    tags=StringAgg('tags__name', delimiter=', ')
)
```

**2. Model.NotUpdated ì˜ˆì™¸ (ì¤‘ê°„ ìš°ì„ ìˆœìœ„)**
- ë” ë‚˜ì€ ì—ëŸ¬ í•¸ë“¤ë§
- ë™ì‹œì„± ì œì–´ ê°œì„ 

```python
try:
    product.save(force_update=True)
except Product.NotUpdated:
    return {"error": "Conflict"}, 409
```

**3. AsyncPaginator (ì„ íƒì )**
- ë†’ì€ íŠ¸ë˜í”½ APIì— íš¨ê³¼ì 
- ASGI í™˜ê²½ í•„ìš”
- ì ì§„ì  ë„ì… ê°€ëŠ¥

### ì‹ ì¤‘í•˜ê²Œ ë„ì…í•  ê¸°ëŠ¥

**1. Background Tasks (ì‹¤í—˜ì )**
- í”„ë¡œë•ì…˜ ì‚¬ìš© ì „ ì¶©ë¶„í•œ í…ŒìŠ¤íŠ¸ í•„ìš”
- Worker ê´€ë¦¬ ë„êµ¬ ë¯¸ì„±ìˆ™
- ì†Œê·œëª¨ í”„ë¡œì íŠ¸ì—ì„œ ë¨¼ì € ì‹œë„

**2. CSP (ë³´ì•ˆ ê°•í™” í•„ìš” ì‹œ)**
- API ì „ìš© ì„œë¹„ìŠ¤ëŠ” ìš°ì„ ìˆœìœ„ ë‚®ìŒ
- Adminì´ë‚˜ ë¬¸ì„œ í˜ì´ì§€ ì‚¬ìš© ì‹œ ê³ ë ¤
- Report-Only ëª¨ë“œë¡œ ë¨¼ì € í…ŒìŠ¤íŠ¸

**3. Template Partials (í…œí”Œë¦¿ ì‚¬ìš© ì‹œë§Œ)**
- JSON API ì¤‘ì‹¬ì´ë©´ ë¶ˆí•„ìš”
- ì´ë©”ì¼ í…œí”Œë¦¿ ë§ìœ¼ë©´ ìœ ìš©

## ğŸ¯ ê²°ë¡ : Django 6.0ìœ¼ë¡œ ì—…ê·¸ë ˆì´ë“œí•´ì•¼ í• ê¹Œ?

### django-ninja ê°œë°œì ê´€ì  ìš”ì•½

**âœ… ì—…ê·¸ë ˆì´ë“œë¥¼ ê¶Œì¥í•˜ëŠ” ê²½ìš°:**
- ìƒˆ í”„ë¡œì íŠ¸ ì‹œì‘
- Python 3.12+ë¥¼ ì´ë¯¸ ì‚¬ìš© ì¤‘
- ë°ì´í„°ë² ì´ìŠ¤ ì¿¼ë¦¬ ìµœì í™”ê°€ í•„ìš”í•œ ê²½ìš°
- ë°±ê·¸ë¼ìš´ë“œ ì‘ì—… ì²˜ë¦¬ê°€ í•„ìš”í•œ ê²½ìš°
- ë³´ì•ˆ ê°•í™”ê°€ ì¤‘ìš”í•œ ê²½ìš° (CSP)

**â¸ï¸ ì—…ê·¸ë ˆì´ë“œë¥¼ ë¯¸ë£° ìˆ˜ ìˆëŠ” ê²½ìš°:**
- ì•ˆì •ì ìœ¼ë¡œ ìš´ì˜ ì¤‘ì¸ í”„ë¡œë•ì…˜ ì„œë¹„ìŠ¤
- Python 3.11 ì´í•˜ë¥¼ ì‚¬ìš© ì¤‘ì´ë©° ì—…ê·¸ë ˆì´ë“œê°€ ì–´ë ¤ìš´ ê²½ìš°
- ë ˆê±°ì‹œ ì˜ì¡´ì„±ì´ ë§ì€ ê²½ìš°
- íŒ€ì˜ í…ŒìŠ¤íŠ¸ ë¦¬ì†ŒìŠ¤ê°€ ë¶€ì¡±í•œ ê²½ìš°

**âš ï¸ ì£¼ì˜ì‚¬í•­:**
- Django 5.2ëŠ” 2026ë…„ 4ì›”ê¹Œì§€ ì§€ì›
- ì¶©ë¶„í•œ í…ŒìŠ¤íŠ¸ ì—†ì´ í”„ë¡œë•ì…˜ì— ë°”ë¡œ ì ìš©í•˜ì§€ ë§ ê²ƒ
- ìŠ¤í…Œì´ì§• í™˜ê²½ì—ì„œ ë¨¼ì € ê²€ì¦
- ë°ì´í„°ë² ì´ìŠ¤ ë°±ì—… í•„ìˆ˜

### ì‹¤ì „ ë¡œë“œë§µ

**1ë‹¨ê³„: í•™ìŠµ ë° ì‹¤í—˜ (1-2ì£¼)**
- ë¡œì»¬ í™˜ê²½ì— Django 6.0 ì„¤ì¹˜
- ìƒˆë¡œìš´ ê¸°ëŠ¥ í…ŒìŠ¤íŠ¸
- ê¸°ì¡´ ì½”ë“œì™€ì˜ í˜¸í™˜ì„± í™•ì¸

**2ë‹¨ê³„: ê°œë°œ í™˜ê²½ ì ìš© (2-3ì£¼)**
- ê°œë°œ ì„œë²„ì— ë°°í¬
- íŒ€ì›ë“¤ê³¼ í•¨ê»˜ í…ŒìŠ¤íŠ¸
- ì´ìŠˆ ë°œê²¬ ë° í•´ê²°

**3ë‹¨ê³„: ìŠ¤í…Œì´ì§• ê²€ì¦ (1-2ì£¼)**
- í”„ë¡œë•ì…˜ê³¼ ë™ì¼í•œ í™˜ê²½ì—ì„œ í…ŒìŠ¤íŠ¸
- ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬
- ëª¨ë‹ˆí„°ë§ ì„¤ì •

**4ë‹¨ê³„: í”„ë¡œë•ì…˜ ë°°í¬ (ê³„íšì— ë”°ë¼)**
- ë¡¤ë°± ê³„íš ì¤€ë¹„
- ì ì§„ì  ë°°í¬ (Blue-Green, Canary ë“±)
- ëª¨ë‹ˆí„°ë§ ê°•í™”

### ì¶”ì²œ í•™ìŠµ ë¦¬ì†ŒìŠ¤

**ê³µì‹ ë¬¸ì„œ:**
- [Django 6.0 Release Notes](https://docs.djangoproject.com/en/6.0/releases/6.0/)
- [Background Tasks Framework](https://docs.djangoproject.com/en/6.0/topics/tasks/)
- [CSP Reference](https://docs.djangoproject.com/en/6.0/ref/csp/)

**django-ninja ê´€ë ¨:**
- [django-ninja ê³µì‹ ë¬¸ì„œ](https://django-ninja.dev/)
- [ë¹„ë™ê¸° ê°€ì´ë“œ](https://django-ninja.dev/guides/async/)

Django 6.0ì€ ë§ì€ ê°œì„ ì‚¬í•­ì„ í¬í•¨í•˜ê³  ìˆì§€ë§Œ, django-ninja ê°œë°œìì—ê²ŒëŠ” **StringAgg**, **AsyncPaginator**, **Background Tasks**ê°€ ê°€ì¥ ì‹¤ìš©ì ì¸ ê¸°ëŠ¥ì…ë‹ˆë‹¤. ì¶©ë¶„í•œ í…ŒìŠ¤íŠ¸ì™€ ê³„íšì„ í†µí•´ ì•ˆì „í•˜ê²Œ ë§ˆì´ê·¸ë ˆì´ì…˜í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.

---

**ì´ ê¸€ì´ ë„ì›€ì´ ë˜ì…¨ë‚˜ìš”?** Django 6.0 ë§ˆì´ê·¸ë ˆì´ì…˜ ê²½í—˜ì´ë‚˜ ì§ˆë¬¸ì´ ìˆìœ¼ì‹œë©´ ëŒ“ê¸€ë¡œ ê³µìœ í•´ì£¼ì„¸ìš”! ğŸš€

